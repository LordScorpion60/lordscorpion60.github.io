<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- HTML Meta Tags -->
    <title>LordScorpion60's Domain - FSX Play Scorecards</title>
    <meta name="description" content="">

    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="https://lordscorpion60.github.io/foresight_sports/fsx_play_courses.html">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="LordScorpion60's Domain">
    <meta property="og:title" content="FSX Play Scorecards">
    <meta property="og:description" content="Explore Foresight Sports FSX Play courses with powerful search tools, detailed information, and images. Save notes, mark favorites, view altitude adjustments, find flyover videos, and share courses. Discover and manage your FSX Play course library.">
    <meta property="og:image" content="https://lordscorpion60.github.io/images/foresight_sports/golf_ball_on_grass.png">

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary">

    <!-- Meta Tags Generated via https://www.opengraph.xyz -->
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <!-- Bootstrap Core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <!--<link href="/css/plugins/metisMenu/metisMenu.min.css" rel="stylesheet">-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/metismenu/dist/metisMenu.min.css">

    <!-- Custom CSS -->
    <link href="/css/sb-admin-2.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/font-awesome-4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- Quill -->
    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.snow.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style>
        div.sticky {
            position: -webkit-sticky; /* Safari */
            position: sticky;
            top: 10px;
            margin-top: 10px;
        }

        /* width */
        ::-webkit-scrollbar {
            width: 25px;
        }

        /* Track */
        ::-webkit-scrollbar-track {
            box-shadow: inset 0 0 5px grey;
            border-radius: 10px;
        }

        /* Handle */
        ::-webkit-scrollbar-thumb {
            background: #428bca;
            border-radius: 8px;
        }

        /* Handle on hover */
        ::-webkit-scrollbar-thumb:hover {
            background: grey;
        }

        input[type='checkbox'] {
            width: 20px;
            height: 20px;
            background: white;
            vertical-align: middle;
            bottom: 3px;
            position: relative;
        }

        .courseBGImg {
            object-fit: contain;
            max-width: 100%;
        }

        .courseNotesBGImg {
            object-fit: contain;
            max-width: 50%;
        }

        .courseHoleImg {
            object-fit: contain;
            max-width: 95%;
        }

        .courseHolesTable {
            cursor: zoom-out !important;
            width: 100%;
            /*margin-bottom: 15px;*/
            font-weight: bold;
            font-size: 16px;
        }

        .updatedCourseDateLink {
            pointer-events: none;
            color: inherit;
        }

        .compareCourseSortable {
            display: inline-block;
            margin: 5px;
            padding: 10px;
            border-style: solid;
            border-width: 1px;
            border-color: #428bca;
            border-radius: 20px;
            zoom: 0.8;
            cursor: grab;
            vertical-align: top;
        }

        .compareCourseTitle {
            display: table;
            margin: auto;
            padding-left: 45px;
        }

        .btn-plain {
            color: #000;
            background-color: #6495ED;
            border-color: #000;
        }

        .btn-plain:hover {
            color: #000;
            background-color: #3071a9;
            border-color: #285e8e;
            transition: all .5s;
        }
    </style>
</head>

<body>
    <div id="wrapper">
        <!-- Navigation -->
        <div id="nav-placeholder">
            <!-- Leave blank so page content loads too -->
        </div>
        <!-- end of Navigation -->
        <!-- Page Content -->
        <div id="page-wrapper">
            <div class="row">
                <div class="col-xs-12">
                    <h1 class="page-header">FSX Play Scorecards</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12">
                    <div class="panel-group" id="accordion">
                        <div class="panel panel-danger" style="display:none">
                            <div class="panel-heading">
                                Disclaimer <i class="fa fa-exclamation-circle"></i>
                            </div>
                            <div class="panel-body">
                                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum tincidunt est vitae ultrices accumsan. Aliquam ornare lacus adipiscing, posuere lectus et, fringilla augue.</p>
                            </div>
                        </div>
                        <div class="panel panel-info">
                            <div class="btn btn-header btn-lg btn-block" data-toggle="collapse" data-parent="#accordionInfo" href="#collapseInfo">
                                <h4 class="panel-title text-left">
                                    Info <i class="fa fa-info-circle"></i>
                                </h4>
                            </div>
                            <div id="collapseInfo" class="panel-collapse collapse">
                                <div class="panel-body">
                                    <p>The following is my repository of scorecards collected from each <a href="https://www.foresightsports.com/collections/fsx-courses" target="_blank">Foresight Sports FSX Play course <i class="fa fa-external-link fa-fw"></i></a> to provide specific search capabilities in order to learn more about the courses you own, are looking to buy, or want to share with a friend.</p>
                                    <p>Each scorecard will have a link to where you can purchase the course, some will have a link to watch a flyover video to learn more about how the course looks in FSX Play.</p>
                                    <p>Be sure to check the Notifications Panel on the <a href="/">home page</a> for updates and new features!</p>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-info">
                            <div class="btn btn-header btn-lg btn-block" data-toggle="collapse" data-parent="#accordionClub" href="#collapseClub">
                                <h4 class="panel-title text-left">
                                    Club Data <i class="fa fa-crosshairs"></i>
                                </h4>
                            </div>
                            <div id="collapseClub" class="panel-collapse collapse">
                                <div class="panel-body">
                                    <p>Enter your carry for each club at sea level (0 ft.) and each selected course will show the adjusted carry for altitude.</p>
                                    <label style="text-align: center">
                                        Driver <input id="clubDataDriver" class="form-control" style="text-align: center; width: 75px;">
                                    </label>
                                    <label style="text-align: center">&nbsp;</label>
                                    <label style="text-align: center">
                                        7 Iron<input id="clubData7Iron" class="form-control" style="text-align: center; width: 75px;">
                                    </label>
                                    <label style="text-align: center">&nbsp;</label>
                                    <label style="text-align: center">
                                        Wedge<input id="clubDataWedge" class="form-control" style="text-align: center; width: 75px;">
                                    </label>
                                    &nbsp;&nbsp;<button id="btnSaveClubData" class="btn btn-info" type="button" data-container="body" data-toggle="popover" data-placement="right" data-content="Club data saved" onclick="saveClubData()">Save</button>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-info">
                            <div class="btn btn-header btn-lg btn-block" data-toggle="collapse" data-parent="#accordionSearch" href="#collapseSearch">
                                <h4 class="panel-title text-left">
                                    Course Search <i class="fa fa-search"></i>
                                </h4>
                            </div>
                            <div id="collapseSearch" class="panel-collapse collapse">
                                <div class="panel-body">
                                    <div class="form-group input-group">
                                        <span class="input-group-addon">Course Name</span>
                                        <span class="input-group-btn" style="width: 105px;">
                                            <select class="form-control" id="ddlNameSearchOperator">
                                                <option>Contains</option>
                                                <option>Equals</option>
                                            </select>
                                        </span>
                                        <input type="text" class="form-control" placeholder="" id="txtNameSearch">
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon">Version</span>
                                        <input type="text" class="form-control" placeholder="" id="txtVersionSearch">
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon">Par</span>
                                        <select class="form-control" id="ddlParSearch">
                                            <option></option>
                                        </select>
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon tooltip-search">Slope <i class="fa fa-info-circle" data-toggle="tooltip" data-placement="bottom" title="Has at least one teebox that has..."></i></span>
                                        <span class="input-group-btn" style="width: 60px;">
                                            <select class="form-control" id="ddlSlopeSearchOperator">
                                                <option>></option>
                                                <option><</option>
                                            </select>
                                        </span>
                                        <input type="text" class="form-control" placeholder="" id="txtSlopeSearch">
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon tooltip-search">Rating <i class="fa fa-info-circle" data-toggle="tooltip" data-placement="bottom" title="Has at least one teebox that has..."></i></span>
                                        <span class="input-group-btn" style="width: 60px;">
                                            <select class="form-control" id="ddlRatingSearchOperator">
                                                <option>></option>
                                                <option><</option>
                                            </select>
                                        </span>
                                        <input type="text" class="form-control" placeholder="" id="txtRatingSearch">
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon tooltip-search">Yardage <i class="fa fa-info-circle" data-toggle="tooltip" data-placement="bottom" title="Has at least one teebox that has..."></i></span>
                                        <span class="input-group-btn" style="width: 60px;">
                                            <select class="form-control" id="ddlYardageSearchOperator">
                                                <option>></option>
                                                <option><</option>
                                            </select>
                                        </span>
                                        <input type="text" class="form-control" placeholder="" id="txtYardageSearch">
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon">Altitude</span>
                                        <span class="input-group-btn" style="width: 60px;">
                                            <select class="form-control" id="ddlAltSearchOperator">
                                                <option>></option>
                                                <option><</option>
                                                <option>=</option>
                                            </select>
                                        </span>
                                        <input type="text" class="form-control" placeholder="" id="txtAltitudeSearch">
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon">Type</span>
                                        <select class="form-control" id="ddlTypeSearch">
                                            <option></option>
                                        </select>
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon">City</span>
                                        <select class="form-control" id="ddlCitySearch">
                                            <option></option>
                                        </select>
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon">Country</span>
                                        <select class="form-control" id="ddlCountrySearch">
                                            <option></option>
                                        </select>
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon">Continent</span>
                                        <select class="form-control" id="ddlContinentSearch">
                                            <option></option>
                                        </select>
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon">State</span>
                                        <select class="form-control" id="ddlStateSearch">
                                            <option></option>
                                        </select>
                                    </div>
                                    <div class="form-group input-group">
                                        <span class="input-group-addon tooltip-search">Price <i class="fa fa-info-circle" data-toggle="tooltip" data-placement="bottom" title="Check current price on Foresight's website using &quot;Buy&quot; link..."></i></span>
                                        <span class="input-group-btn" style="width: 60px;">
                                            <select class="form-control" id="ddlPriceSearchOperator" onchange="ddlPriceSearchOperatorFromChange(this.value)">
                                                <option>=</option>
                                                <option><</option>
                                                <option>></option>
                                            </select>
                                        </span>
                                        <input type="text" class="form-control" style="width: 200px;" placeholder="" id="txtPriceSearch">
                                        <span class="input-group-btn" style="float: left; width: 60px;">
                                            <select class="form-control" id="ddlPriceMaxSearchOperator" onchange="ddlPriceSearchOperatorToChange(this.value)" disabled>
                                                <option></option>
                                                <option><</option>
                                            </select>
                                        </span>
                                        <input type="text" class="form-control" style="width: 200px;" placeholder="" id="txtPriceMaxSearch" disabled>
                                    </div>
                                    <div class="panel panel-default" style="margin-bottom: 15px;">
                                        <div class="panel-heading" style="padding: 6px 12px;">
                                            Has Flyover Video <input type="checkbox" id="chkHasFlyoverVideo">
                                        </div>
                                    </div>
                                    <div class="panel panel-default" style="margin-bottom: 15px;">
                                        <div class="panel-heading" style="padding: 6px 12px;">
                                            Is Favorite <input type="checkbox" id="chkIsFavorite">
                                        </div>
                                    </div>
                                    <div class="panel panel-default">
                                        <div class="panel-heading" style="padding: 6px 12px;">
                                            <span class="tooltip-search">FSX 2020 <i class="fa fa-info-circle" data-toggle="tooltip" data-placement="bottom" title="Does FSX 2020 version exist..."></i></span> <input type="checkbox" id="chkIs2020">
                                        </div>
                                    </div>
                                </div>
                                <div id="searchFooter" class="panel-footer small">
                                    <button id="btnSearchCourseName" class="btn btn-info" type="button" onclick="searchCourse()">
                                        Search
                                    </button>
                                    <button id="btnSearchCourseName" class="btn btn-warning" type="button" data-container="body" data-toggle="popover" data-placement="top" data-content="Search Filters Reset" onclick="searchCourseReset()">
                                        Reset
                                    </button>
                                    <button id="btnSearchShare" class="btn btn-outline btn-primary" data-container="body" data-toggle="popover" data-placement="top" data-content="" onclick="shareSearch()">
                                        Share Search <i class="fa fa-share-alt"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-info">
                            <div class="btn btn-header btn-lg btn-block" data-toggle="collapse" data-parent="#accordionClub" href="#collapseCompare">
                                <h4 class="panel-title text-left">
                                    Course Compare <i class="fa fa-exchange"></i> (<span id="courseCompareCount">0</span>)
                                </h4>
                            </div>
                            <div id="collapseCompare" class="panel-collapse collapse">
                                <div class="panel-body" style="padding: 5px;">
                                    <div class="panel-body" id="course_compare_placeholder" style="display:none">
                                        <!-- Template to load courses raw -->
                                    </div>
                                    <div class="panel-body" id="course_compare_placeholder_toSort" style="display:none">
                                        <!-- Template to load courses sorted -->
                                    </div>
                                    <div class="panel-body" id="course_compare_results" style="overflow-x: auto; white-space: nowrap; padding: 5px;">
                                        <!-- Leave blank so course compare loads -->
                                    </div>
                                </div>
                                <div id="compareFooter" class="panel-footer small">
                                    <button id="btnResetCourseCompare" class="btn btn-warning" type="button" data-container="body" data-toggle="popover" data-placement="top" data-content="All courses removed from compare list" onclick="courseCompareReset()">
                                        Remove All
                                    </button>
                                    <button id="btnCompareShare" class="btn btn-outline btn-primary" data-container="body" data-toggle="popover" data-placement="top" data-content="" onclick="shareCompareList()">
                                        Share Compare List <i class="fa fa-share-alt"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12 col-md-8">
                    <h4 id="courseResultCount">Courses loaded</h4>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-4 col-md-4" id="courseList" style="height: 900px; overflow-y: auto; overflow-x:hidden;">
                    <!-- Built on load -->
                </div>
                <div class="col-xs-8 col-md-8">
                    <div class="panel panel-primary" style="display: table; width:100%;">
                        <div class="panel-heading">
                            <i class="fa fa-arrow-left"></i> Click on a course to load it's scorecard here <i class="fa fa-arrow-down"></i>
                        </div>
                        <div class="panel-body" id="course_placeholder">
                            <!-- Leave blank so course content loads -->
                        </div>
                        <!-- Image Modal -->
                        <div class="modal fade" id="courseImageModal" tabindex="-1" role="dialog" aria-labelledby="courseImageModalTitle" aria-hidden="true">
                            <div class="modal-dialog" style="width: auto; margin: 10px; justify-content: center; text-align: center;">
                                <div class="modal-content">
                                    <div class="modal-header" style="padding: 5px;">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-right: 7px; margin-top:0px; font-size: 30px;">&times;</button>
                                        <h4 class="modal-title" id="courseImageModalTitle">Course Name</h4>
                                    </div>
                                    <div id="courseModalBody" class="modal-body" data-dismiss="modal" style="padding: 10px; cursor: zoom-out">
                                        <img id="courseImageModalFull" class="courseHoleImg" />
                                        <table id="courseHolesAllTable" class="courseHolesTable">
                                            <tbody>
                                                <tr>
                                                    <td>1</td>
                                                    <td>2</td>
                                                    <td>3</td>
                                                    <td>4</td>
                                                    <td>5</td>
                                                    <td>6</td>
                                                    <td>7</td>
                                                    <td>8</td>
                                                    <td>9</td>
                                                </tr>
                                                <tr>
                                                    <td><img id="courseHoleImg_1" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_2" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_3" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_4" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_5" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_6" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_7" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_8" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_9" class="courseHoleImg" /></td>
                                                </tr>
                                                <tr style="height:20px">
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>10</td>
                                                    <td>11</td>
                                                    <td>12</td>
                                                    <td>13</td>
                                                    <td>14</td>
                                                    <td>15</td>
                                                    <td>16</td>
                                                    <td>17</td>
                                                    <td>18</td>
                                                </tr>
                                                <tr>
                                                    <td><img id="courseHoleImg_10" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_11" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_12" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_13" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_14" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_15" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_16" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_17" class="courseHoleImg" /></td>
                                                    <td><img id="courseHoleImg_18" class="courseHoleImg" /></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <div id="courseNotesAll" style="cursor:default; display:inline-block;">
                                            <div id="courseNotesToolbar">
                                                <span class="ql-formats">
                                                    <select class="ql-font"></select>
                                                    <select class="ql-size"></select>
                                                </span>
                                                <span class="ql-formats">
                                                    <button class="ql-bold"></button>
                                                    <button class="ql-italic"></button>
                                                    <button class="ql-underline"></button>
                                                    <button class="ql-strike"></button>
                                                </span>
                                                <span class="ql-formats">
                                                    <select class="ql-color"></select>
                                                    <select class="ql-background"></select>
                                                </span>
                                                <span class="ql-formats">
                                                    <button class="ql-script" value="sub"></button>
                                                    <button class="ql-script" value="super"></button>
                                                </span>
                                                <span class="ql-formats">
                                                    <button class="ql-header" value="1"></button>
                                                    <button class="ql-header" value="2"></button>
                                                    <button class="ql-blockquote"></button>
                                                    <button class="ql-code-block"></button>
                                                </span>
                                                <span class="ql-formats">
                                                    <button class="ql-list" value="ordered"></button>
                                                    <button class="ql-list" value="bullet"></button>
                                                    <button class="ql-indent" value="-1"></button>
                                                    <button class="ql-indent" value="+1"></button>
                                                    <select class="ql-align"></select>
                                                </span>
                                                <span class="ql-formats">
                                                    <button class="ql-link"></button>
                                                </span>
                                                <span class="ql-formats">
                                                    <button class="ql-clean"></button>
                                                </span>
                                            </div>
                                            <div id="courseNotesEditor" style="height: 150px;">
                                            </div>
                                            <button id="btnSaveCourseNotes" class="btn btn-date-header btn-lg btn-block" onclick="saveCourseNotes()" data-container="body" data-toggle="popover" data-placement="top">Save <i class="fa fa-save"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- /Modal -->
                        <div class="panel-footer" id="courseFooter" style="display:none">
                            <table width="100%">
                                <tr>
                                    <td align="left">
                                        <button class="btn btn-outline btn-primary" id="courseCompare" data-container="body" data-toggle="popover" data-placement="top" data-content="" onclick="addCourseCompare()">Compare <i id="courseCompareIcon" class="fa fa-plus"></i></button>
                                        <button class="btn btn-outline btn-primary" id="courseNotes" onclick="takeCourseNotes()" title="Take notes on this course">Notes <i class="fa fa-pencil"></i></button>
                                        <a class="btn btn-outline btn-primary" data-container="body" data-toggle="popover" data-placement="top" data-content="URL copied to clipboard" onclick="shareCourse()">
                                            Share <i class="fa fa-share-alt"></i>
                                        </a>
                                        <span class="tooltip-search">
                                            <button class="btn btn-outline btn-primary" id="courseFavorite" onclick="markCourseFavorite()" data-toggle="tooltip" data-placement="top" title="Choice will persist on your next visit">Favorite <i id="courseFavoriteStar" class="fa fa-star-o"></i></button>
                                        </span>
                                        <a class="btn btn-outline btn-primary" id="courseBuyLink" href="#" style="display:none" target="_blank">Buy <i class="fa fa-shopping-cart"></i></a>
                                        <a class="btn btn-outline btn-primary" id="courseFlyoverLink" href="#" style="display:none" target="_blank">Watch Flyover <i class="fa fa-video-camera"></i></a>
                                        <button class="btn btn-outline btn-primary" id="courseRequestFlyover" data-container="body" data-toggle="popover" data-placement="top" data-content="Request sent!" style="display:none" onclick="requestFlyOverVideo()">Request Flyover <i class="fa fa-bullhorn"></i></button>
                                    </td>
                                    <td align="right">
                                        <div style="display: none; vertical-align: middle;" id="clubDataAltAdj">
                                            &nbsp;<button type="button" id="btnAltAdj" class="btn btn-info disabled" style="color: #000; opacity: .8;"><b>Alt Gain:</b> <span id="courseAltAdj"></span></button>
                                            <button type="button" id="btnDriverAltAdj" class="btn btn-info disabled" style="color: #000; opacity: .8; display:none;"><b>D:</b> <span id="clubDriverAltAdj"></span></button>
                                            <button type="button" id="btn7IronAltAdj" class="btn btn-info disabled" style="color: #000; opacity: .8; display: none;"><b>7i:</b> <span id="club7IronAltAdj"></span></button>
                                            <button type="button" id="btnWedgeAltAdj" class="btn btn-info disabled" style="color: #000; opacity: .8; display: none;"><b>W:</b> <span id="clubWedgeAltAdj"></span></button>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /#wrapper -->
    <!-- Site Functions -->
    <script src="/js/site.js"></script>

    <!-- jQuery Version 1.11.0 -->
    <script src="/js/jquery-1.11.0.js"></script>

    <!-- jQuery UI Version 1.13.3 -->
    <script src="/js/jquery-ui.js"></script>

    <!-- jQuery UI Touch Punch 0.2.3 -->
    <script src="/js/jquery.ui.touch-punch.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <!--<script src="/js/plugins/metisMenu/metisMenu.min.js"></script>-->
    <script src="https://cdn.jsdelivr.net/npm/metismenu"></script>

    <!-- Custom Theme JavaScript -->
    <script src="/js/sb-admin-2.js"></script>

    <!-- Quill -->
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.2/dist/quill.js"></script>

    <script>

        // Variable to hold course information
        var documentTitle = document.title;
        var courseArr = {};
        var courseMediaArr = {};
        var userInfo = "[NO_IP]";
        var searchDataFound = false;
        var isDebug = false;
        var quill = null;

        $("[data-toggle=popover]").popover({
            delay: {
                show: 100,
                hide: 100
            }
        });

        $('.tooltip-search').tooltip({
            selector: "[data-toggle=tooltip]",
            container: "body"
        })

        $("[data-toggle=popover]").on('shown.bs.popover', function () {
            setTimeout(function (a) {
                a.popover('hide');
            }, 1500, $(this));
        });

        // Wire up keyboard enter key for course searching
        $("#txtNameSearch").on('keypress', function (event) {
            if (event.which === 13) {
                searchCourse();
            }
        });

        $("#txtVersionSearch").on('keypress', function (event) {
            if (event.which === 13) {
                searchCourse();
            }
        });

        $("#txtAltitudeSearch").on('keypress', function (event) {
            if (event.which === 13) {
                searchCourse();
            }
        });

        $("#txtSlopeSearch").on('keypress', function (event) {
            if (event.which === 13) {
                searchCourse();
            }
        });

        $("#txtRatingSearch").on('keypress', function (event) {
            if (event.which === 13) {
                searchCourse();
            }
        });

        $("#txtYardageSearch").on('keypress', function (event) {
            if (event.which === 13) {
                searchCourse();
            }
        });

        $("#txtPriceSearch").on('keypress', function (event) {
            if (event.which === 13) {
                searchCourse();
            }
        });

        $("#txtPriceMaxSearch").on('keypress', function (event) {
            if (event.which === 13) {
                searchCourse();
            }
        });

        // On page-load.
        $(function () {
            SetDebugMode();
            var debugType = "OnLoad";
            $("#course_compare_results").sortable({
                start: function (event, ui) {
                    // Event when user starts to drag item
                },
                stop: function (event, ui) {
                    // Event when user drops item
                    $(ui.item).css("cursor", "grab");
                    var compareOrder = $("#course_compare_results").sortable('toArray').toString();

                    var newCourseCompareList = compareOrder.replaceAll("compare_", "").split(",");

                    if (newCourseCompareList.length > 1) {
                        // Only save new order if there is more than one in the list...
                        Debug("Saving sorted course compare list...");

                        SessionStorage('set', "courseCompareList", JSON.stringify(newCourseCompareList));
                    }
                }
            });

            $("#nav-placeholder").load("/nav.html");

            // Check QS params when page loads in case we got a course to load up
            const queryParams = new URLSearchParams(window.location.search);

            var queryCourse = queryParams.get('course');
            var querySearch = queryParams.get('search');
            var queryCompare = queryParams.get('compare');

            var selectedCourse = SessionStorage('get', "selectedCourse");

            Debug("selectedCourse: " + selectedCourse, debugType);
            Debug("query string course: " + queryCourse, debugType);

            var queryCourseAfterAmp = "";

            for (const key of queryParams.keys()) {
                if (key.startsWith(" ") && queryParams.get(key).length == 0) {
                    Debug("course query string w/ amp: '" + key + "'", debugType);
                    queryCourseAfterAmp = key;
                }
            }

            if (queryCourseAfterAmp.length > 0) {
                // We need to assume the course has an unescaped & in it and need to re-build the course name
                queryCourse += "&" + queryCourseAfterAmp;
                Debug("updated query string course: " + queryCourse, debugType);
            }

            var isCourseinURLorSelected = false;

            // Read in json course data
            $.getJSON("/foresight_sports/fsx_play_courses/zz_allCourseData.json").done(function (data) {
                window.courseArr = data;

                Debug('course json loaded...', debugType);
                Debug('courses found: ' + window.courseArr.length, debugType);

                if (window.courseArr.length > 0) {
                    LoadSearchDropdowns();
                    $("#courseResultCount").html("Courses found: " + window.courseArr.length);
                }

                // Restore any seach criteria if from refresh/reload
                if (window.performance) {
                    if (window.performance.getEntriesByType("navigation")[0].type === "reload") {

                        // Page was reloaded
                        Debug("Page was reloaded...", debugType);
                    }
                    else {
                        // Page was not reloaded
                        Debug("Page was not reloaded...", debugType);

                        if (document.referrer != null && document.referrer.includes("foresight_sports/fsx_play_courses/")) {
                            // Came in from course share link, clear any prior searches in existing sessions
                            Debug("Page load came from course page...", debugType);
                            SessionStorage('remove', 'lastSearch');
                        }
                    }
                }
                else {
                    console.warn("Navigation Timing API is not supported on this browser!");
                }

                var lastSearch = SessionStorage('get', 'lastSearch');

                // Read in json course media data
                $.getJSON("/foresight_sports/fsx_play_courses/aa_allCourseMediaData.json").done(function (data) {
                    window.courseMediaArr = data;

                    Debug('course media json loaded...', debugType);

                    if (querySearch != null) {
                        // User passed in search
                        Debug("search passed in via URL: " + querySearch, debugType);

                        try {
                            var searchString_dec = Base64_decode_url(querySearch);

                            Debug("decoded URL search string:" + searchString_dec, debugType);

                            // Restore search criteria to each field on the page...
                            PreloadSearchCriteria(searchString_dec);
                        }
                        catch (e) {
                            console.warn('could not parse search url parameter: ' + e);
                            ResetURL();
                        }
                    }
                    else if (queryCourse != null) {
                        // User passed in course query
                        Debug("Need to reload selected course from URL: " + queryCourse, debugType);
                        isCourseinURLorSelected = true;

                        SessionStorage('remove', 'lastSearch');

                        Debug("Loading scorecard from query search: " + queryCourse, debugType);
                        loadScoreCard(queryCourse);
                    }
                    else if (selectedCourse != null) {
                        // User previously selected a course
                        Debug("Need to reload selected course from previous selected: " + selectedCourse, debugType);
                        isCourseinURLorSelected = true;

                        Debug("Restore last search criteria and/or selected course that might be cached...", debugType);

                        if (lastSearch != null) {
                            Debug("previous search found...", debugType);
                            // Restore search criteria to each field on the page...
                            PreloadSearchCriteria(lastSearch);
                        }
                        else {
                            Debug("no previous search found...", debugType);
                        }

                        Debug("Loading scorecard from last selected: " + selectedCourse, debugType);
                        loadScoreCard(selectedCourse);
                    }
                    else if (lastSearch != null) {
                        Debug("previous search found...", debugType);
                        // Restore search criteria to each field on the page...
                        PreloadSearchCriteria(lastSearch);
                    }
                    else {
                        // Remove all query string parameters just in case - Should be just be first hit to page
                        Debug("no actions to take!", debugType);
                        ResetURL();
                    }
                }).done(function (data) {
                    if (window.searchDataFound) {
                        // Expand search criteria box
                        $('#collapseSearch').addClass('in');
                        // Re-run search
                        Debug("Re-run search...", debugType);
                        searchCourse(isCourseinURLorSelected);
                        window.searchDataFound = false;
                    }
                }).fail(function (data) {
                    console.warn('no course media data found!');
                });

                // User passed in compare list
                if (queryCompare != null) {
                    Debug("compare list passed in via URL: " + queryCompare, debugType);

                    try {
                        if (queryCompare.length > 0) {
                            var compareString_dec = Base64_decode_url(queryCompare);

                            Debug("decoded URL compare list string:" + compareString_dec, debugType);

                            // Replace compare list with that passed in
                            var courseCompareList = compareString_dec.split(",");

                            if (courseCompareList != null) {
                                //Check each course against course manifest, kick out any that are not legit...

                                newCompareList = [];

                                courseCompareList.forEach((compareCourse) => {
                                    if (window.courseArr.find((element) => element.Name == compareCourse)) {
                                        newCompareList.push(compareCourse);
                                        Debug("clean compare course passed in: " + compareCourse, debugType);
                                    }
                                    else {
                                        console.warn("Invalid compare course passed in will be ommitted: " + compareCourse);
                                    }
                                });

                                Debug("Clean course compare list: " + newCompareList, debugType);

                                $("#courseCompareCount").text(newCompareList.length);

                                if (newCompareList.length > 0) {
                                    // Leave this here if you only want shared compare lists to auto expand the compare panel
                                    $('#collapseCompare').addClass('in');
                                }

                                SessionStorage('set', "courseCompareList", JSON.stringify(newCompareList));
                            }
                        }
                        else {
                            throw ("cannot proccess an empty string...");
                        }
                    }
                    catch (e) {
                        console.warn('could not parse compare url parameter: ' + e);
                        ResetURL();
                    }
                }

                compareCourses();
            }).fail(function (data) {
                console.warn('no course data found!');
            });

            GetUserData();
            LoadClubData();
        });

        async function GetUserData() {
            var debugType = "GetUserData";

            try {
                var request1 = await fetch('https://api.ipify.org?format=json')
                    .then(response => response.json())
                    .then(data => {
                        window.userInfo = "[" + data.ip + "]";

                        $.getJSON("https://ipinfo.io/json?token=e96ec5b44f0930").done(function (ipData) {
                            window.userInfo = "[" + ipData.ip + ":" + ipData.city + ":" + ipData.country + ":" + ipData.postal + "]";

                            Debug(ipData, debugType);
                        }).fail(function (data) {
                            Debug('no extra user data could be loaded!', debugType);
                        }).always(function (data) {
                            Debug(window.userInfo, debugType);
                        });
                    })
                    .catch(error => {
                        Debug('Error fetching IP:' + error, debugType);
                    });
            }
            catch (e) {
                Debug("could not get user IP: " + e, debugType);
            }
        }

        function ddlPriceSearchOperatorFromChange(value) {
            if (value == "=" || value == "<") {
                $("#ddlPriceMaxSearchOperator").val('');
                $('#ddlPriceMaxSearchOperator').attr('disabled', true);
                $('#txtPriceMaxSearch').attr('disabled', true);
                $('#txtPriceMaxSearch').val('');
            }
            else {
                $('#ddlPriceMaxSearchOperator').attr('disabled', false);
            }
        }

        function ddlPriceSearchOperatorToChange(value) {
            if (value == "") {
                $('#txtPriceMaxSearch').attr('disabled', true);
                $('#txtPriceMaxSearch').val('');
            }
            else {
                $('#txtPriceMaxSearch').attr('disabled', false);
            }
        }

        function PreloadSearchCriteria(searchData) {

            var searchArr = searchData.split('|');

            $.each(searchArr, function PreloadSearchCriterias(index, value) {
                var searchField = value.split(';');
                var searchTerm = UnEscapeURL(searchField[1]);

                // Name
                if (searchField[0] == ('courseName') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('courseName: ' + searchTerm + ' ' + searchField[2]);

                    $("#txtNameSearch").val(searchTerm);
                    $("#ddlNameSearchOperator").val(searchField[2]);
                }
                // Version
                if (searchField[0] == ('courseVersion') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('courseVersion: ' + searchTerm);

                    $("#txtVersionSearch").val(searchTerm);
                }
                // Par
                if (searchField[0] == ('coursePar') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('coursePar: ' + searchTerm);

                    $("#ddlParSearch").val(searchTerm);
                }
                // Type
                if (searchField[0] == ('courseType') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('courseType: ' + searchTerm);

                    $("#ddlTypeSearch").val(searchTerm);
                }
                // Altitude
                if (searchField[0] == ('courseAlt') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('courseAlt: ' + searchTerm + ' ' + searchField[2]);

                    $("#txtAltitudeSearch").val(searchTerm);
                    $("#ddlAltSearchOperator").val(searchField[2]);
                }
                // City
                if (searchField[0] == ('courseCity') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('courseCity: ' + searchTerm);

                    $("#ddlCitySearch").val(searchTerm);
                }
                // Country
                if (searchField[0] == ('courseCountry') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('courseCountry: ' + searchTerm);

                    $("#ddlCountrySearch").val(searchTerm);
                }
                // Continent
                if (searchField[0] == ('courseContinent') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('courseContinent: ' + searchTerm);

                    $("#ddlContinentSearch").val(searchTerm);
                }
                // State
                if (searchField[0] == ('courseState') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('courseState: ' + searchTerm);

                    $("#ddlStateSearch").val(searchTerm);
                }
                // Slope
                if (searchField[0] == ('courseSlope') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('courseSlope: ' + searchTerm + ' ' + searchField[2]);

                    $("#txtSlopeSearch").val(searchTerm);
                    $("#ddlSlopeSearchOperator").val(searchField[2]);
                }
                // Rating
                if (searchField[0] == ('courseRating') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('courseRating: ' + searchTerm + ' ' + searchField[2]);

                    $("#txtRatingSearch").val(searchTerm);
                    $("#ddlRatingSearchOperator").val(searchField[2]);
                }
                // Yardage
                if (searchField[0] == ('courseYardage') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('courseYardage: ' + searchTerm + ' ' + searchField[2]);

                    $("#txtYardageSearch").val(searchTerm);
                    $("#ddlYardageSearchOperator").val(searchField[2]);
                }
                // Has Flyover Video
                if (searchField[0] == ('courseHasFlyoverVideoIsChecked')) {
                    window.searchDataFound = true;

                    Debug('courseHasFlyoverVideoIsChecked: ' + searchTerm);

                    $("#chkHasFlyoverVideo").prop("checked", searchTerm.toLowerCase() === "true");
                }
                // Is Favorite
                if (searchField[0] == ('courseIsFavoriteIsChecked')) {
                    window.searchDataFound = true;

                    Debug('courseIsFavoriteIsChecked: ' + searchTerm);

                    $("#chkIsFavorite").prop("checked", searchTerm.toLowerCase() === "true");
                }
                // Is 2020
                if (searchField[0] == ('courseIs2020IsChecked')) {
                    window.searchDataFound = true;

                    Debug('courseIs2020IsChecked: ' + searchTerm);

                    $("#chkIs2020").prop("checked", searchTerm.toLowerCase() === "true");
                }
                // Price
                if (searchField[0] == ('coursePrice') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('coursePrice: ' + searchTerm + ' ' + searchField[2]);

                    $("#txtPriceSearch").val(searchTerm);
                    $("#ddlPriceSearchOperator").val(searchField[2]);

                    ddlPriceSearchOperatorFromChange(searchField[2]);
                }
                // PriceMax
                if (searchField[0] == ('coursePriceMax') && searchTerm.length > 0) {
                    window.searchDataFound = true;

                    Debug('coursePriceMax: ' + searchTerm + ' ' + searchField[2]);

                    $("#txtPriceMaxSearch").val(searchTerm);
                    $("#ddlPriceMaxSearchOperator").val(searchField[2]);

                    if ($("#ddlPriceSearchOperator").val() == '>') {
                        ddlPriceSearchOperatorToChange('<');
                    }
                    else {
                        $("#ddlPriceSearchOperator").val('>');
                        ddlPriceSearchOperatorFromChange('>');
                        ddlPriceSearchOperatorToChange('<');
                    }
                }
            });
        }

        function LoadClubData() {
            var clubDriver = LocalStorage('get', "clubData_Driver");
            var club7Iron = LocalStorage('get', "clubData_7Iron");
            var clubWedge = LocalStorage('get', "clubData_Wedge");

            if (clubDriver != null) {
                $('#clubDataDriver').val(clubDriver);
            }

            if (club7Iron != null) {
                $('#clubData7Iron').val(club7Iron);
            }

            if (clubWedge != null) {
                $('#clubDataWedge').val(clubWedge);
            }
        }

        function saveClubData() {
            var clubDriver = $('#clubDataDriver').val();
            var club7Iron = $('#clubData7Iron').val();
            var clubWedge = $('#clubDataWedge').val();
            var errMsg = "";
            var finalMsg = "";

            var regex = /^[0-9]+$/;

            if (!clubDriver.match(regex) || Number(clubDriver) == 0 || Number(clubDriver) > 999) {
                if (clubDriver.length == 0) {
                    LocalStorage('remove', "clubData_Driver");
                }
                else {
                    errMsg = "Use a number (1-999) for Driver";
                }
            }
            else {
                LocalStorage('set', "clubData_Driver", clubDriver);
            }

            if (!club7Iron.match(regex) || Number(club7Iron) == 0 || Number(club7Iron) > 999) {
                if (club7Iron.length == 0) {
                    LocalStorage('remove', "clubData_7Iron");
                }
                else {
                    if (errMsg.length == 0) {
                        errMsg = "Use a number (1-999) for 7 Iron";
                    }
                    else {
                        errMsg += " & 7 Iron";
                    }
                }
            }
            else {
                LocalStorage('set', "clubData_7Iron", club7Iron);
            }

            if (!clubWedge.match(regex) || Number(clubWedge) == 0 || Number(clubWedge) > 999) {
                if (clubWedge.length == 0) {
                    LocalStorage('remove', "clubData_Wedge");
                }
                else {
                    if (errMsg.length == 0) {
                        errMsg = "Use a number (1-999) for Wedge";
                    }
                    else {
                        errMsg += " & Wedge";
                    }
                }
            }
            else {
                LocalStorage('set', "clubData_Wedge", clubWedge);
            }

            if (errMsg.length > 0) {
                finalMsg = errMsg;
            }
            else if (clubDriver.length == 0 && club7Iron.length == 0 && clubWedge.length == 0) {
                finalMsg = "Nothing to save...";
            }
            else {
                finalMsg = "Club data saved";
            }

            var yourElement = document.getElementById("btnSaveClubData");
            yourElement.setAttribute("data-content", finalMsg);

            Debug(finalMsg);

            // Check QS params in case we need to reload the scorecard to use new values
            var selectedCourse = SessionStorage('get', "selectedCourse");

            if (selectedCourse != null) {
                Debug("course is already selected, reload it to show new club data: " + selectedCourse);
                loadScoreCard(selectedCourse);
            }
        }

        function LoadSearchDropdowns() {

            $.each(window.courseArr, function () {

                // Build course list
                var $courseButton = $('<button onclick="loadScoreCard(\'' + EscapeHTML(this.Name.replace("'", "\\'")) + '\')" type="button" class="btn btn-outline btn-primary btn-lg btn-block courseButton" style="margin: 10px">' + this.Name + '</button>');
                $courseButton.appendTo($("#courseList"));

                //PAR
                if (this.Par) {
                    var parExists = ($('#ddlParSearch').find('option[value="' + this.Par + '"]').length != 0);

                    if (!parExists) {
                        $('#ddlParSearch').append($('<option></option>').val(this.Par).html(this.Par));
                    }
                }

                //TYPE
                if (this.Type) {
                    var typeExists = ($('#ddlTypeSearch').find('option[value="' + this.Type + '"]').length != 0);

                    if (!typeExists) {
                        $('#ddlTypeSearch').append($('<option></option>').val(this.Type).html(this.Type));
                    }
                }

                //CITY
                if (this.City && this.City.length > 0) {
                    var cityExists = ($('#ddlCitySearch').find('option[value="' + this.City + '"]').length != 0);

                    if (!cityExists) {
                        $('#ddlCitySearch').append($('<option></option>').val(this.City).html(this.City));
                    }
                }

                //COUNTRY
                if (this.Country && this.Country.length > 0) {
                    var countryExists = ($('#ddlCountrySearch').find('option[value="' + this.Country + '"]').length != 0);

                    if (!countryExists) {
                        $('#ddlCountrySearch').append($('<option></option>').val(this.Country).html(this.Country));
                    }
                }

                //CONTINENT
                if (this.Continent && this.Continent.length > 0) {
                    var continentExists = ($('#ddlContinentSearch').find('option[value="' + this.Continent + '"]').length != 0);

                    if (!continentExists) {
                        $('#ddlContinentSearch').append($('<option></option>').val(this.Continent).html(this.Continent));
                    }
                }

                //STATE
                if (this.State && this.State.length > 0) {
                    var stateExists = ($('#ddlStateSearch').find('option[value="' + this.State + '"]').length != 0);

                    if (!stateExists) {
                        $('#ddlStateSearch').append($('<option></option>').val(this.State).html(this.State));
                    }
                }
            });

            Debug('courses added...');

            // Sort Par list
            var pars = $("#ddlParSearch option");
            pars.detach().sort(function (a, b) {
                var at = $(a).text();
                var bt = $(b).text();
                return (at > bt) ? 1 : ((at < bt) ? -1 : 0);
            });
            pars.appendTo("#ddlParSearch");
            $("#ddlParSearch").val(''); // Select default blank value

            // Sort Type list
            var types = $("#ddlTypeSearch option");
            types.detach().sort(function (a, b) {
                var at = $(a).text();
                var bt = $(b).text();
                return (at > bt) ? 1 : ((at < bt) ? -1 : 0);
            });
            types.appendTo("#ddlTypeSearch");
            $("#ddlTypeSearch").val(''); // Select default blank value

            // Sort City list
            var cities = $("#ddlCitySearch option");
            cities.detach().sort(function (a, b) {
                var at = $(a).text();
                var bt = $(b).text();
                return (at > bt) ? 1 : ((at < bt) ? -1 : 0);
            });
            cities.appendTo("#ddlCitySearch");
            $("#ddlCitySearch").val(''); // Select default blank value

            // Sort Country list
            var countries = $("#ddlCountrySearch option");
            countries.detach().sort(function (a, b) {
                var at = $(a).text();
                var bt = $(b).text();
                return (at > bt) ? 1 : ((at < bt) ? -1 : 0);
            });
            countries.appendTo("#ddlCountrySearch");
            $("#ddlCountrySearch").val(''); // Select default blank value

            // Sort Continent list
            var continents = $("#ddlContinentSearch option");
            continents.detach().sort(function (a, b) {
                var at = $(a).text();
                var bt = $(b).text();
                return (at > bt) ? 1 : ((at < bt) ? -1 : 0);
            });
            continents.appendTo("#ddlContinentSearch");
            $("#ddlContinentSearch").val(''); // Select default blank value

            // Sort State list
            var states = $("#ddlStateSearch option");
            states.detach().sort(function (a, b) {
                var at = $(a).text();
                var bt = $(b).text();
                return (at > bt) ? 1 : ((at < bt) ? -1 : 0);
            });
            states.appendTo("#ddlStateSearch");
            $("#ddlStateSearch").val(''); // Select default blank value

            Debug('search dropdowns populated...');
        }

        function shareCourse() {
            var copyText = GetSelectedCourseName();

            var path = window.location.href.split('?')[0]
            var shareURL = path.replace(".html", "") + "/" + EscapeURL(copyText) + ".html";

            SendToClipboard(shareURL);
        }

        function GetSelectedCourseName() {
            var courseDiv = document.getElementById("courseName");
            var courseName = courseDiv.innerText;

            return courseName
        }

        function shareCompareList() {
            var courseCompareList = JSON.parse(SessionStorage('get', "courseCompareList"));
            var yourElement = document.getElementById("btnCompareShare");
            var finalMsg = "Course list copied to clipboard";

            if (courseCompareList != null && courseCompareList.length > 0) {
                Debug("course compare list to share: " + courseCompareList);

                try {
                    var compareString_enc = Base64_encode_url(courseCompareList);

                    var path = window.location.href.split('?')[0]
                    var shareURL = path + "?compare=" + EscapeURL(compareString_enc);

                    SendToClipboard(shareURL);
                }
                catch (e) {
                    finalMsg = "Error sharing course compare list!"
                    console.warn(finalMsg + "-" + e);
                }
            }
            else {
                finalMsg = "No compare criteria to share!";
            }

            yourElement.setAttribute("data-content", finalMsg);
        }

        function shareSearch() {
            var searchCriteria = GetSearchCriteria();
            var yourElement = document.getElementById("btnSearchShare");
            var finalMsg = "URL copied to clipboard";

            if (searchCriteria.hasData) {
                Debug("search criteria to share: " + searchCriteria.searchString);

                try {
                    var searchString_enc = Base64_encode_url(searchCriteria.searchString);

                    var path = window.location.href.split('?')[0]
                    var shareURL = path + "?search=" + EscapeURL(searchString_enc);

                    SendToClipboard(shareURL);
                }
                catch (e) {
                    finalMsg = "Error sharing URL!"
                    console.warn(finalMsg + "-" + e);
                }
            }
            else {
                finalMsg = "No search criteria to share!";
            }

            yourElement.setAttribute("data-content", finalMsg);
        }

        function loadScoreCard(course) {
            try {
                Debug("Trying to load scorecard for course: " + course);

                // Make sure the course is the full proper name of the course and update incase a partial url was passed in (YT kill's courses ended in ')')
                var matchedCourses = window.courseArr.filter(function (a) { return (a.Name.toLowerCase() == course.toLowerCase()) });

                if (matchedCourses == 0) {
                    Debug("course not an exact match...");
                    // Not an exact match, so check for partial matches...
                    matchedCourses = window.courseArr.filter(function (a) { return (a.Name.toLowerCase().includes(course.toLowerCase())) });
                }
                else {
                    // Exact match, just check for improper cased course name
                    if (course != matchedCourses[0].Name) {
                        Debug("passed in course name is not correct case. Updating...");
                        course = matchedCourses[0].Name;
                        SessionStorage('remove', 'lastSearch');
                    }
                }

                var matchCourseCount = matchedCourses.length;
                Debug("scorecards matching course value: " + matchCourseCount);

                if (matchCourseCount == 1) {
                    // Partial match is unique, change the course name to be correct and proceed
                    if (course.toLowerCase() != matchedCourses[0].Name.toLowerCase()) {
                        course = matchedCourses[0].Name;
                        Debug("passed in course name is incorrect. Updating to: " + course);
                        SessionStorage('remove', 'lastSearch');
                    }
                }

                if (matchCourseCount != 1) {
                    // Too many courses match the passed in course name, so we need to redirect to a course name search...
                    Debug("No direct course match, loading search instead...");

                    var newSearch = "courseName;" + course + ";Contains";

                    PreloadSearchCriteria(newSearch);
                    // Expand search criteria box
                    $('#collapseSearch').addClass('in');
                    // Run search
                    searchCourse();
                }
                else {
                    Debug("Direct course match, loading scorecard...");

                    // Reset the query string parameter if we already loaded a course and reset the search parameters
                    ResetURL();

                    // Update page title to show current loaded course
                    document.title = documentTitle + " - " + course;

                    // Save the course if user clicks on a course to load
                    SessionStorage('set', "selectedCourse", course);

                    $("#course_placeholder").load(encodeURIComponent("fsx_play_courses/" + course + ".html"), function () {

                        $('#courseDataTable tr').each(function () {
                            $(this).css('cursor', 'default');
                        })

                        $('#courseYardageTable tr').each(function () {
                            $(this).css('cursor', 'default');
                        })

                        $('#courseHolesTable tr').each(function () {
                            $(this).css('cursor', 'default');
                        })

                        var courseHoleImage = course.replaceAll(" ", "_") + "$##HOLE##_.png";

                        $('#courseHolesTable th').each(function (i, i1) {
                            if ($(i1)[0].innerText == "Hole") {
                                $(i1).on("click", function () {
                                    $('#courseHolesTable tr td:first-child').each(function (ii, i2) {
                                        var holeNo = $(i2)[0].innerText;
                                        var courseHoleImageURL = encodeURIComponent("fsx_play_course_images/" + courseHoleImage.replace("##HOLE##", holeNo)).replace("(", "%28").replace(")", "%29").replace("'", "%27");
                                        var courseHole = "#courseHoleImg_" + holeNo;
                                        $(courseHole).attr("src", courseHoleImageURL);
                                    })
                                })

                                $(this).css('cursor', 'zoom-in');
                                $(this).css('text-decoration', 'underline');
                                $(this).attr("title", "See all holes at once");

                                var oldBGColor = $(this).css("background-color");

                                $(this).on('mouseenter', function () {
                                    $(this).css("background-color", "#5bc0de");
                                    $(this).css('text-decoration', 'none');
                                }).on('mouseleave', function () {
                                    $(this).css("background-color", oldBGColor);
                                    $(this).css('text-decoration', 'underline');
                                })
                            }
                        });

                        $('#courseHolesTable tr td:first-child').each(function () {
                            $(this).on("click", function () {
                                var holeNo = $(this)[0].innerText;
                                $('#courseImageModalTitle').text(course + ' - Hole: ' + holeNo);

                                var courseHoleImageURL = encodeURIComponent("fsx_play_course_images/" + courseHoleImage.replace("##HOLE##", holeNo)).replace("(", "%28").replace(")", "%29").replace("'", "%27");
                                $("#courseImageModalFull").attr("src", courseHoleImageURL);
                            })

                            $(this).css('cursor', 'zoom-in');
                            $(this).css('text-decoration', 'underline');

                            var oldBGColor = $(this).css("background-color");

                            $(this).on('mouseenter', function () {
                                $(this).css("background-color", "#428bca");
                                $(this).css('text-decoration', 'none');
                            }).on('mouseleave', function () {
                                $(this).css("background-color", oldBGColor);
                                $(this).css('text-decoration', 'underline');
                            })
                        })
                    });

                    var x = document.getElementById("courseFooter");

                    if (x.style.display === "none") {
                        x.style.display = "block";
                    }

                    // Set Course Compare state
                    var courseCompareList = JSON.parse(SessionStorage('get', "courseCompareList"));
                    var inCourseCompare = false;

                    if (courseCompareList != null) {
                        // Check to see if already exists
                        if ((courseCompareList.some(courseCompare => courseCompare === course)) === true) {
                            inCourseCompare = true;
                        }
                    }

                    Debug("Is course in compare list: " + inCourseCompare);

                    SetCourseCompareIcon(inCourseCompare);

                    // Set Course Favorite Button
                    var courseFav = LocalStorage('get', course + "_favorite");

                    Debug("Is course a favorite: " + courseFav);

                    SetCourseFavoriteStar(courseFav);

                    var y = document.getElementById("courseBuyLink");
                    var z = document.getElementById("courseFlyoverLink");
                    var zz = document.getElementById("courseRequestFlyover");
                    var clubDataDiv = document.getElementById("clubDataAltAdj");
                    var clubDriverBtn = document.getElementById("btnDriverAltAdj");
                    var club7IronBtn = document.getElementById("btn7IronAltAdj");
                    var clubWedgeBtn = document.getElementById("btnWedgeAltAdj");

                    var clubDriver = LocalStorage('get', "clubData_Driver");
                    var club7Iron = LocalStorage('get', "clubData_7Iron");
                    var clubWedge = LocalStorage('get', "clubData_Wedge");

                    clubDriverBtn.style.display = "none";
                    club7IronBtn.style.display = "none";
                    clubWedgeBtn.style.display = "none";

                    Debug("driver set to: " + clubDriver);
                    Debug("7i set to: " + club7Iron);
                    Debug("wedge set to: " + clubWedge);

                    var courseAlt = window.courseArr.find(item => item.Name === course).Altitude;
                    // Altitude(y) to % gain(x): 0.00002y=x
                    altGain = (0.00002 * courseAlt);

                    Debug("course alt: " + courseAlt);

                    var courseAltAdj = Math.round((altGain * 100));

                    Debug("course alt gain: " + courseAltAdj);

                    if (courseAltAdj > 0) {
                        clubDataDiv.style.display = "table-cell";

                        $("#courseAltAdj").text(courseAltAdj + "%");

                        if (clubDriver != null || club7Iron != null || clubWedge != null) {

                            if (clubDriver != null) {
                                var newDriver = clubDriver;

                                try {
                                    newDriver = Number(clubDriver);
                                    newDriver = Math.round((newDriver * altGain) + newDriver);
                                }
                                catch (e) {
                                    console.warn("error calculating driver altitude adjustment: " + e);
                                }

                                clubDriverBtn.style.display = "";
                                $("#clubDriverAltAdj").text(newDriver);
                            }

                            if (club7Iron != null) {
                                var new7Iron = club7Iron;

                                try {
                                    new7Iron = Number(club7Iron);
                                    new7Iron = Math.round((new7Iron * altGain) + new7Iron);
                                }
                                catch (e) {
                                    console.warn("error calculating 7iron altitude adjustment: " + e);
                                }

                                club7IronBtn.style.display = "";
                                $("#club7IronAltAdj").text(new7Iron);
                            }

                            if (clubWedge != null) {
                                var newWedge = clubWedge;

                                try {
                                    newWedge = Number(clubWedge);
                                    newWedge = Math.round((newWedge * altGain) + newWedge);
                                }
                                catch (e) {
                                    console.warn("error calculating wedge altitude adjustment: " + e);
                                }

                                clubWedgeBtn.style.display = "";
                                $("#clubWedgeAltAdj").text(newWedge);
                            }
                        }
                    }
                    else {
                        clubDataDiv.style.display = "none";
                    }

                    // Update the course background image
                    UpdateCourseModal(course);

                    var matchingCourse = window.courseMediaArr.find(item => item.Name === course);

                    if (typeof matchingCourse !== 'undefined') {
                        // Course media data found, set links with available information
                        Debug("course media match: " + JSON.stringify(matchingCourse));

                        //Check for Course Buy link
                        if (matchingCourse.Buy != null && matchingCourse.Buy.length > 0) {
                            y.style.display = "";
                            y.href = matchingCourse.Buy;
                            y.title = "";

                            if (matchingCourse.Price != null && matchingCourse.Price.length > 0) {
                                y.title = "MSRP: $" + matchingCourse.Price;
                            }
                        }
                        else {
                            y.style.display = "none";
                            y.href = "#";
                        }

                        //Check for Course Flyover link
                        if (matchingCourse.Flyover != null && matchingCourse.Flyover.length > 0) {
                            z.style.display = ""
                            z.href = matchingCourse.Flyover;

                            zz.style.display = "none";
                        }
                        else {
                            z.style.display = "none";
                            z.href = "#";

                            zz.style.display = "";
                        }
                    }
                    else {
                        // No media data found, so clean out links
                        Debug("no course media match!");

                        y.style.display = "none";
                        y.href = "#";

                        z.style.display = "none";
                        z.href = "#";

                        zz.style.display = "none";
                    }
                }
            }
            catch (error) {
                console.error("error loading scorecard: ", error);
            }
        }

        function UpdateCourseModal(course) {
            var courseImageURL = GetCourseImage(course);

            Debug("Updating course modal images...");

            $('#course_placeholder').css('background-image', "url(" + courseImageURL + ")");
            $('#course_placeholder').css('background-size', "cover");
            $('#course_placeholder').css('cursor', 'zoom-in');
            $('#course_placeholder').on("click", function (e) {
                var senderElement = e.target;
                // Clear modal
                $('#course_placeholder').attr('data-target', '');
                $('#course_placeholder').attr('data-toggle', '');

                // Check if sender is the parent placeholder <div> element
                if ($(e.target).is("div")) {
                    Debug('course_placeholder - clicked', "Event");
                    $('#courseImageModalTitle').text(course);
                    $("#courseImageModalFull").attr("src", courseImageURL);
                    $('#course_placeholder').attr('data-target', '#courseImageModal');
                    $('#course_placeholder').attr('data-toggle', 'modal');

                    ShowActiveModal("courseImageModalFull");
                }
                else if ($(e.target).is("td") && e.target.style.cursor == 'zoom-in') {
                    Debug('course_hole - clicked', "Event");
                    $('#course_placeholder').attr('data-target', '#courseImageModal');
                    $('#course_placeholder').attr('data-toggle', 'modal');

                    ShowActiveModal("courseImageModalFull");
                }
                else if ($(e.target).is("th") && e.target.style.cursor == 'zoom-in') {
                    Debug('course_all_holes - clicked', "Event");
                    $('#courseImageModalTitle').text(course);
                    $('#course_placeholder').attr('data-target', '#courseImageModal');
                    $('#course_placeholder').attr('data-toggle', 'modal');

                    ShowActiveModal("courseHolesAllTable");
                }
                return true;
            })
        }

        function ShowActiveModal(elementID) {
            $('#courseImageModalFull').hide();
            $('#courseHolesAllTable').hide();
            $('#courseNotesAll').hide();

            // For course notes we want the default cursor and turn off most modal dismiss options so user can work...
            if (elementID == "courseNotesAll") {
                $('#courseModalBody').attr('data-dismiss', '');
                $('#courseModalBody').css('cursor', 'default');
            }
            else {
                $('#courseModalBody').attr('data-dismiss', 'modal');
                $('#courseModalBody').css('cursor', 'zoom-out');
            }

            $('#' + elementID).show();
        }

        function RemoveCourseModal() {
            $('#course_placeholder').css('background-image', "");
            $('#course_placeholder').attr('data-target', '');
            $('#course_placeholder').attr('data-toggle', '');
            $('#courseImageModalTitle').text('Course Name');
            $('#course_placeholder').css('cursor', '');
        }

        function UnhideAllCourses() {
            // Reset the course background image
            RemoveCourseModal();

            document.querySelectorAll('.courseButton').forEach(function (el) {
                el.style.display = 'block';
            });

            $("#course_placeholder").empty();
        }

        function GetCourseImage(course) {
            var courseImage = course.replaceAll(" ", "_") + "_.png";
            var courseImageURL = "fsx_play_course_images/" + encodeURIComponent(courseImage).replace("(", "%28").replace(")", "%29").replace("'", "%27");

            Debug("courseImageURL: " + courseImageURL);

            return courseImageURL;
        }

        function searchCourseReset() {
            SessionStorage('remove', 'lastSearch');
            SessionStorage('remove', 'selectedCourse');

            $("#txtNameSearch").val('');
            $("#ddlNameSearchOperator").val('Contains'); // Select default value
            $("#txtVersionSearch").val('');
            $("#ddlParSearch").val(''); // Select default blank value
            $("#txtSlopeSearch").val('');
            $("#ddlSlopeSearchOperator").val('>'); // Select default value
            $("#txtRatingSearch").val('');
            $("#ddlRatingSearchOperator").val('>'); // Select default value
            $("#txtYardageSearch").val('');
            $("#ddlYardageSearchOperator").val('>'); // Select default value
            $("#txtAltitudeSearch").val('');
            $("#ddlAltSearchOperator").val('>'); // Select default value
            $("#ddlCitySearch").val(''); // Select default blank value
            $("#ddlCountrySearch").val(''); // Select default blank value
            $("#ddlContinentSearch").val(''); // Select default blank value
            $("#ddlStateSearch").val(''); // Select default blank value
            $("#ddlTypeSearch").val(''); // Select default blank value
            $("#txtPriceSearch").val('');
            $("#ddlPriceSearchOperator").val('='); // Select default value
            ddlPriceSearchOperatorFromChange('=');

            $("#chkHasFlyoverVideo").prop("checked", false);
            $("#chkIsFavorite").prop("checked", false);
            $("#chkIs2020").prop("checked", false);

            UnhideAllCourses();

            $("#courseResultCount").html("Courses found: " + window.courseArr.length);

            var x = document.getElementById("courseFooter");

            if (x.style.display === "block") {
                x.style.display = "none";
            }

            ResetURL();
        }

        function LoadNoteEditor(existingNotes) {
            try {
                if (window.quill == null) {
                    window.quill = new Quill('#courseNotesEditor', {
                        modules: {
                            toolbar: '#courseNotesToolbar',
                        },
                        placeholder: 'Add your personal notes and Save when done. Your saved notes will be available the next time you come back...',
                        theme: 'snow',
                    });
                    Debug("initializing editor for the first time...");
                }

                if (existingNotes == null) {
                    window.quill.setText('\n');
                    Debug("loading editor with no notes...");
                }
                else {
                    Debug("course notes found, loading them into editor...");
                    window.quill.setContents(JSON.parse(existingNotes));
                }
            }
            catch (e) {
                alert("There was an error loading the course notes editor. Cannot take notes at this time...");
                console.warn("Quill could not be loaded: " + e);
            }
        }

        function takeCourseNotes() {
            var course = GetSelectedCourseName();

            Debug("Taking notes for course: " + course);

            var existingNotes = LocalStorage('get', course + "_notes");

            LoadNoteEditor(existingNotes);

            $('#courseImageModalTitle').text(course + " - Notes");
            $('#courseNotes').attr('data-target', '#courseImageModal');
            $('#courseNotes').attr('data-toggle', 'modal');

            ShowActiveModal("courseNotesAll");
        }

        function saveCourseNotes() {
            var course = GetSelectedCourseName();

            Debug("Saving course notes for: " + course);

            var btnSaveCourseNotesTooltip = document.getElementById("btnSaveCourseNotes");
            var finalMsg = "Notes Saved!";

            var courseNotes = window.quill.getContents();
            var notesLength = window.quill.getLength();

            if (notesLength > 1) {
                try {
                    LocalStorage('set', course + "_notes", JSON.stringify(courseNotes));
                }
                catch (e) {
                    finalMsg = "Error saving course notes!"
                    console.warn(finalMsg + "-" + e);
                }
            }
            else {
                finalMsg = "No notes to save!";
            }

            btnSaveCourseNotesTooltip.setAttribute("data-content", finalMsg);
            Debug(finalMsg);
        }

        function removeCourseCompare(course) {

            var courseCompareList = JSON.parse(SessionStorage('get', "courseCompareList"));
            var selectedCourse = "";

            try {
                selectedCourse = GetSelectedCourseName();
            }
            catch {
                console.log("No course selected, no compare icons to update...");
            }

            if (courseCompareList != null) {
                Debug("Removing course from compare: " + course);

                courseCompareList = courseCompareList.filter(function (item) {
                    return item !== course
                })

                SessionStorage('set', "courseCompareList", JSON.stringify(courseCompareList));

                // Update button if selected course
                if (selectedCourse == course) {
                    SetCourseCompareIcon(false);
                }

                // Update compare count
                $("#courseCompareCount").text(courseCompareList.length);

                compareCourses();
            }
        }

        function addCourseCompare() {
            var course = GetSelectedCourseName();

            Debug("Selected course: " + course);

            var courseCompareList = JSON.parse(SessionStorage('get', "courseCompareList"));
            var addCourse = false;
            var yourElement = document.getElementById("courseCompare");
            var finalMsg = "";

            if (courseCompareList != null) {
                // Check to see if already exists
                if ((courseCompareList.some(courseCompare => courseCompare === course)) === false) {
                    // Course doesn't exist, add it...
                    addCourse = true;
                    courseCompareList.push(course);
                }
            }
            else {
                // Add course for the first time
                courseCompareList = [];
                courseCompareList.push(course);
                addCourse = true;
            }

            if (addCourse) {
                Debug("Adding course to compare: " + course);
                finalMsg = "Course added to compare list";
            }
            else {
                Debug("Removing course from compare: " + course);
                finalMsg = "Course removed from compare list";

                courseCompareList = courseCompareList.filter(function (item) {
                    return item !== course
                })
            }

            SessionStorage('set', "courseCompareList", JSON.stringify(courseCompareList));

            // Update tooltip
            yourElement.setAttribute("data-content", finalMsg);

            // Update button
            SetCourseCompareIcon(addCourse);

            // Update compare count
            $("#courseCompareCount").text(courseCompareList.length);

            // Update compare
            compareCourses();
        }

        function BuildDynamicCompareCourse(courseData) {
            var loadedCourse = $("#course_compare_placeholder");
            loadedCourse.html(courseData);

            var titleDiv = loadedCourse.find('.courseTitle').html();
            Debug("course title: " + titleDiv, "BuildDynamicCompareCourse");

            var btnTitle = $("<button>").attr({
                'class': "btn btn-plain",
                'onclick': "loadScoreCard('" + titleDiv.replace("'", "\\'") + "')"
            }).html(titleDiv)

            // Remove existing course title so we can replace it with a button
            loadedCourse.find('.courseTitle').html(btnTitle);
            loadedCourse.find('.courseTitle').addClass('compareCourseTitle');
            loadedCourse.find('.courseTitle').removeClass('courseTitle');

            var courseHtml = loadedCourse.html()
                .replace('id="courseName"', '')
                .replace('id="courseHolesTable"', '')
                .replace('id="courseYardageTable"', '')
                .replace('id="courseDataTable"', '');

            var btnDrag = $("<button>").attr({
                'class': "btn btn-info btn-circle disabled",
                'style': "float: left;"
            }).html('<i class="fa fa-reorder"></i>');

            var btnRemove = $("<button>").attr({
                'class': "btn btn-danger",
                'style': "float: right;",
                'onclick': "removeCourseCompare('" + titleDiv.replace("'", "\\'") + "')"
            }).text("Remove")

            var divHtml = $("<div>").attr({
                'id': "compare_" + titleDiv,
                'class': "compareCourseSortable",
                'onmousedown': "$(this).css(\'cursor\', \'grabbing\')",
                'onmouseup': "$(this).css(\'cursor\', \'grab\')"
            })
                .append(btnDrag)
                .append(btnRemove)
                .append(courseHtml)

            $("#course_compare_placeholder_toSort").append(divHtml);
        }

        function compareCourses() {

            $("#course_compare_results").html('');

            var courseCompareList = JSON.parse(SessionStorage('get', "courseCompareList"));

            if (courseCompareList != null) {
                $("#courseCompareCount").text(courseCompareList.length);
                // Check to see if already exists
                $("#course_compare_placeholder_toSort").html('');
                $("#course_compare_placeholder").html('');

                // Leave this here if you want the compare list to always open if there are courses in the list
                //$('#collapseCompare').addClass('in');

                // Array of course requests
                var courseRequests = Array();
                var existingCourses = [];

                courseCompareList.forEach((course) => {
                    //TODO: Check #course_compare_results to see if we have already downloaded the course and use that instead

                    //var existingCourse = $("#course_compare_results");
                    //var courseHTML = existingCourse.find('[id="compare_' + course + '"]');
                    //console.dir(courseHTML[0]);

                    var courseHTML = null;

                    if (courseHTML != null) {
                        Debug("Reuse existing: " + course, "compareCourses");
                        existingCourses.push(courseHTML.context.children[0].outerHTML);
                    }
                    else {
                        Debug("Download: fsx_play_courses/" + course + ".html", "compareCourses");
                        courseRequests.push($.get(encodeURIComponent("fsx_play_courses/" + course + ".html")));
                    }
                });

                var defer = $.when.apply($, courseRequests);

                defer.done(function () {
                    // This is executed only after every ajax request has been completed
                    Debug("Downloads completed: " + courseRequests.length, "compareCourses - defer");

                    $.each(arguments, function (index, responseData) {
                        // "responseData" will contain an array of response information for each specific request

                        if (typeof responseData === 'string' && responseData.startsWith("<!DOCTYPE html")) {
                            BuildDynamicCompareCourse(responseData);
                        }
                        else if (typeof responseData === 'object' && responseData[0] != null && responseData[0].startsWith("<!DOCTYPE html")) {
                            BuildDynamicCompareCourse(responseData[0]);
                        }
                    });

                    Debug("existingCourses.length: " + existingCourses.length, "compareCourses - defer");

                    if (existingCourses.length > 0) {
                        existingCourses.forEach((course) => {
                            BuildDynamicCompareCourse(course);
                        });
                    }

                    Debug("Call setTimeout...", "compareCourses - defer");
                    $("#course_compare_placeholder").html('');
                    setTimeout(compareCoursesSort, 100);
                });

                Debug("DONE!");
            }
        }

        function compareCoursesSort() {
            Debug("setTimeout triggered...");

            $("#course_compare_results").html('');
            var courseCompareList = JSON.parse(SessionStorage('get', "courseCompareList"));

            courseCompareList.forEach((course) => {
                try {
                    var $matchedCourseFind = $('[id="compare_' + course + '"]').clone();

                    Debug(course + " - matched to - " + $matchedCourseFind[0].id, "compareCoursesSort");

                    $("#course_compare_results").append($matchedCourseFind);
                }
                catch (e) {
                    console.warn("Cannot load compare data for: " + course + " - " + e);
                }
            });

            $("#course_compare_placeholder_toSort").html('');
            $("#course_compare_placeholder").html('');
        }

        function courseCompareReset() {
            var courseCompareList = [];
            SessionStorage('set', "courseCompareList", JSON.stringify(courseCompareList));

            // Update compare count
            $("#courseCompareCount").text(courseCompareList.length);

            // Check QS params in case we need to reload the scorecard to use new values
            var selectedCourse = SessionStorage('get', "selectedCourse");

            if (selectedCourse != null) {
                Debug("A course is selected, reload it to update compare icon: " + selectedCourse);
                loadScoreCard(selectedCourse);
            }

            compareCourses();
        }

        function markCourseFavorite() {
            var course = GetSelectedCourseName();

            var fav = LocalStorage('get', course + "_favorite");

            Debug("fav from storage: " + fav + " " + typeof fav);

            if (fav == null) {
                fav = true;
            }
            else if (fav === 'true') {
                fav = false;
            }
            else {
                fav = true;
            }

            Debug(course + " new fav: " + fav);

            if (fav) {
                LocalStorage('set', course + "_favorite", fav);
            }
            else {
                LocalStorage('remove', course + "_favorite");
            }

            SetCourseFavoriteStar(fav);
        }

        function SetCourseFavoriteStar(fav) {
            if (fav === 'true' || fav === true) {
                $("#courseFavoriteStar").removeClass("fa-star-o");
                $("#courseFavoriteStar").addClass("fa-star");
            }
            else {
                $("#courseFavoriteStar").removeClass("fa-star");
                $("#courseFavoriteStar").addClass("fa-star-o");
            }
        }

        function SetCourseCompareIcon(set) {
            if (set === 'true' || set === true) {
                $("#courseCompareIcon").removeClass("fa-plus");
                $("#courseCompareIcon").addClass("fa-minus");
            }
            else {
                $("#courseCompareIcon").removeClass("fa-minus");
                $("#courseCompareIcon").addClass("fa-plus");
            }
        }

        function requestFlyOverVideo() {
            var course = GetSelectedCourseName();

            var hasSentCourseRequest = LocalStorage('get', course + "_requestedFlyover");

            Debug("hasSentCourseRequest from storage: " + hasSentCourseRequest + " " + typeof hasSentCourseRequest);

            if (hasSentCourseRequest == null) {
                var msg = "Requesting a flyover video for: " + course;

                SendMessage(msg);

                Debug("Message sent - " + msg);

                LocalStorage('set', course + "_requestedFlyover", true);
            }
            else {
                Debug("A request has already sent for: " + course + " - Nothing to do...");
            }
        }

        function GetSearchCriteria() {
            // Texts
            var courseName = $("#txtNameSearch").val();
            var courseVersion = $("#txtVersionSearch").val();
            var courseAlt = $("#txtAltitudeSearch").val();
            var courseYardage = $("#txtYardageSearch").val();
            var courseSlope = $("#txtSlopeSearch").val();
            var courseRating = $("#txtRatingSearch").val();
            var coursePrice = $("#txtPriceSearch").val();
            var coursePriceMax = $("#txtPriceMaxSearch").val();

            // DDLs
            var coursePar = $("#ddlParSearch").val();
            var courseType = $("#ddlTypeSearch").val();
            var courseCity = $("#ddlCitySearch").val();
            var courseCountry = $("#ddlCountrySearch").val();
            var courseContinent = $("#ddlContinentSearch").val();
            var courseState = $("#ddlStateSearch").val();

            // CHKs
            var courseHasFlyoverVideoIsChecked = $("#chkHasFlyoverVideo").prop("checked");
            var courseIsFavoriteIsChecked = $("#chkIsFavorite").prop("checked");
            var courseIs2020Checked = $("#chkIs2020").prop("checked");

            // Operators
            var courseNameSearchOperator = $("#ddlNameSearchOperator").val();
            var courseAltSearchOperator = $("#ddlAltSearchOperator").val();
            var courseSlopeSearchOperator = $("#ddlSlopeSearchOperator").val();
            var courseRatingSearchOperator = $("#ddlRatingSearchOperator").val();
            var courseYardageSearchOperator = $("#ddlYardageSearchOperator").val();
            var coursePriceSearchOperator = $("#ddlPriceSearchOperator").val();
            var coursePriceMaxSearchOperator = $("#ddlPriceMaxSearchOperator").val();

            var obj = new Object();
            var searchString = "";

            obj.courseName = (courseName.length > 0) ? courseName : "";
            obj.courseVersion = (courseVersion.length > 0) ? courseVersion : "";
            obj.courseAlt = (courseAlt.length > 0) ? courseAlt : "";
            obj.courseYardage = (courseYardage.length > 0) ? courseYardage : "";
            obj.courseSlope = (courseSlope.length > 0) ? courseSlope : "";
            obj.courseRating = (courseRating.length > 0) ? courseRating : "";
            obj.coursePar = (coursePar.length > 0) ? coursePar : "";
            obj.courseType = (courseType.length > 0) ? courseType : "";
            obj.courseCity = (courseCity.length > 0) ? courseCity : "";
            obj.courseCountry = (courseCountry.length > 0) ? courseCountry : "";
            obj.courseContinent = (courseContinent.length > 0) ? courseContinent : "";
            obj.courseState = (courseState.length > 0) ? courseState : "";
            obj.courseHasFlyoverVideoIsChecked = courseHasFlyoverVideoIsChecked;
            obj.courseIsFavoriteIsChecked = courseIsFavoriteIsChecked;
            obj.courseIs2020IsChecked = courseIs2020Checked;
            obj.courseNameSearchOperator = courseNameSearchOperator;
            obj.courseAltSearchOperator = courseAltSearchOperator;
            obj.courseSlopeSearchOperator = courseSlopeSearchOperator;
            obj.courseRatingSearchOperator = courseRatingSearchOperator;
            obj.courseYardageSearchOperator = courseYardageSearchOperator;
            obj.coursePrice = (coursePrice.length > 0) ? coursePrice : "";
            obj.coursePriceMax = (coursePriceMax.length > 0) ? coursePriceMax : "";
            obj.coursePriceSearchOperator = coursePriceSearchOperator;
            obj.coursePriceMaxSearchOperator = coursePriceMaxSearchOperator;

            if (courseName.length > 0) {
                searchString += "courseName;" + EscapeURL(obj.courseName) + ";" + obj.courseNameSearchOperator;
                Debug("search term - courseName: " + obj.courseNameSearchOperator + " " + obj.courseName);
            }
            if (courseVersion.length > 0) {
                searchString += "|courseVersion;" + EscapeURL(obj.courseVersion);
                Debug("search term - courseVersion: " + obj.courseVersion);
            }
            if (coursePar.length > 0) {
                searchString += "|coursePar;" + obj.coursePar;
                Debug("search term - coursePar: " + obj.coursePar);
            }
            if (courseType.length > 0) {
                searchString += "|courseType;" + obj.courseType;
                Debug("search term - courseType: " + obj.courseType);
            }
            if (courseAlt.length > 0) {
                searchString += "|courseAlt;" + EscapeURL(obj.courseAlt) + ";" + obj.courseAltSearchOperator;
                Debug("search term - courseAlt: " + obj.courseAltSearchOperator + " " + obj.courseAlt);
            }
            if (courseCity.length > 0) {
                searchString += "|courseCity;" + obj.courseCity;
                Debug("search term - courseCity: " + obj.courseCity);
            }
            if (courseCountry.length > 0) {
                searchString += "|courseCountry;" + obj.courseCountry;
                Debug("search term - courseCountry: " + obj.courseCountry);
            }
            if (courseContinent.length > 0) {
                searchString += "|courseContinent;" + obj.courseContinent;
                Debug("search term - courseContinent: " + obj.courseContinent);
            }
            if (courseState.length > 0) {
                searchString += "|courseState;" + obj.courseState;
                Debug("search term - courseState: " + obj.courseState);
            }
            if (courseYardage.length > 0) {
                searchString += "|courseYardage;" + EscapeURL(obj.courseYardage) + ";" + obj.courseYardageSearchOperator;
                Debug("search term - courseYardage: " + obj.courseYardageSearchOperator + " " + obj.courseYardage);
            }
            if (courseSlope.length > 0) {
                searchString += "|courseSlope;" + EscapeURL(obj.courseSlope) + ";" + obj.courseSlopeSearchOperator;
                Debug("search term - courseSlope: " + obj.courseSlopeSearchOperator + " " + obj.courseSlope);
            }
            if (courseRating.length > 0) {
                searchString += "|courseRating;" + EscapeURL(obj.courseRating) + ";" + obj.courseRatingSearchOperator;
                Debug("search term - courseRating: " + obj.courseRatingSearchOperator + " " + obj.courseRating);
            }
            if (coursePrice.length > 0) {
                searchString += "|coursePrice;" + EscapeURL(obj.coursePrice) + ";" + obj.coursePriceSearchOperator;
                Debug("search term - coursePrice: " + obj.coursePriceSearchOperator + " " + obj.coursePrice);
            }
            if (coursePriceMax.length > 0) {
                searchString += "|coursePriceMax;" + EscapeURL(obj.coursePriceMax) + ";" + obj.coursePriceMaxSearchOperator;
                Debug("search term - coursePriceMax: " + obj.coursePriceMaxSearchOperator + " " + obj.coursePriceMax);
            }

            // Add checkboxes
            if (obj.courseHasFlyoverVideoIsChecked) {
                searchString += "|courseHasFlyoverVideoIsChecked;" + obj.courseHasFlyoverVideoIsChecked;
                Debug("search check box - courseHasFlyoverVideoIsChecked: " + obj.courseHasFlyoverVideoIsChecked);
            }
            if (obj.courseIsFavoriteIsChecked) {
                searchString += "|courseIsFavoriteIsChecked;" + obj.courseIsFavoriteIsChecked;
                Debug("search check box - courseIsFavoriteIsChecked: " + obj.courseIsFavoriteIsChecked);
            }
            if (obj.courseIs2020IsChecked) {
                searchString += "|courseIs2020IsChecked;" + obj.courseIs2020IsChecked;
                Debug("search check box - courseIs2020IsChecked: " + obj.courseIs2020IsChecked);
            }

            // Clean up and finish
            if (searchString.startsWith('|')) {
                searchString = searchString.replace('|', '');
            }

            obj.searchString = searchString;
            obj.hasData = (searchString.length > 0);

            Debug("has search data: " + obj.hasData);

            return obj;
        }

        function searchCourse(isCourseSelected = false) {
            Debug("searchCourse - isCourseSelected: " + isCourseSelected);

            if (!isCourseSelected) {
                Debug("Unhide courses and reset URL...");
                UnhideAllCourses();
                ResetURL();
                SessionStorage('remove', 'selectedCourse');

                var x = document.getElementById("courseFooter");

                if (x.style.display === "block") {
                    x.style.display = "none";
                }
            }

            var searchCriteria = GetSearchCriteria();

            // Check to see if we have any search parameters to actually do a search
            if (searchCriteria.hasData) {
                // Store search criteria for page refresh/reload
                SessionStorage("set", "lastSearch", searchCriteria.searchString);

                // Perform search
                var matches = window.courseArr.filter(function (course) {
                    // Name
                    if (searchCriteria.courseName.length > 0) {
                        if (searchCriteria.courseNameSearchOperator == "Equals") {
                            return course.Name.toLowerCase() == searchCriteria.courseName.toLowerCase();
                        }
                        else {
                            return course.Name.toLowerCase().includes(searchCriteria.courseName.toLowerCase());
                        }
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Version
                    if (searchCriteria.courseVersion.length > 0) {
                        return course.Version.startsWith(searchCriteria.courseVersion);
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Par
                    if (searchCriteria.coursePar.length > 0) {
                        return course.Par == searchCriteria.coursePar;
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Type
                    if (searchCriteria.courseType.length > 0) {
                        return course.Type == searchCriteria.courseType;
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Altitude
                    if (searchCriteria.courseAlt.length > 0) {
                        if (searchCriteria.courseAltSearchOperator == "=") {
                            return course.Altitude == searchCriteria.courseAlt;
                        }
                        else if (searchCriteria.courseAltSearchOperator == ">") {
                            return course.Altitude > searchCriteria.courseAlt;
                        }
                        else {
                            return course.Altitude < searchCriteria.courseAlt;
                        }
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // City
                    if (searchCriteria.courseCity.length > 0) {
                        return course.City == searchCriteria.courseCity;
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Country
                    if (searchCriteria.courseCountry.length > 0) {
                        return course.Country == searchCriteria.courseCountry;
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Continent
                    if (searchCriteria.courseContinent.length > 0) {
                        return course.Continent == searchCriteria.courseContinent;
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // State
                    if (searchCriteria.courseState.length > 0) {
                        return course.State == searchCriteria.courseState;
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Slope
                    if (searchCriteria.courseSlope.length > 0) {
                        if (searchCriteria.courseSlopeSearchOperator == ">") {
                            return searchCriteria.courseSlope < course.MaxSlope;
                        }
                        else {
                            return searchCriteria.courseSlope > course.MinSlope;
                        }
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Rating
                    if (searchCriteria.courseRating.length > 0) {
                        if (searchCriteria.courseRatingSearchOperator == ">") {
                            return searchCriteria.courseRating < course.MaxRating;
                        }
                        else {
                            return searchCriteria.courseRating > course.MinRating;
                        }
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Yardage
                    if (searchCriteria.courseYardage.length > 0) {
                        if (searchCriteria.courseYardageSearchOperator == ">") {
                            return searchCriteria.courseYardage < course.MaxYardage;
                        }
                        else {
                            return searchCriteria.courseYardage > course.MinYardage;
                        }
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Has Flyover Video
                    if (searchCriteria.courseHasFlyoverVideoIsChecked) {
                        var matchingCourse = window.courseMediaArr.find(item => item.Name === course.Name);

                        if (typeof matchingCourse !== 'undefined') {
                            //Check for Course Flyover link
                            if (matchingCourse.Flyover != null && matchingCourse.Flyover.length > 0) {
                                return course
                            }
                        }
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Is Favorite
                    if (searchCriteria.courseIsFavoriteIsChecked) {
                        var matchingCourse = LocalStorage('get', course.Name + "_favorite");

                        if (typeof matchingCourse !== 'undefined') {
                            if (matchingCourse != null && matchingCourse === 'true') {
                                return course
                            }
                        }
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Is FSX 2020
                    if (searchCriteria.courseIs2020IsChecked) {
                        var matchingCourse = window.courseMediaArr.find(item => item.Name === course.Name);

                        if (typeof matchingCourse !== 'undefined') {
                            //Check for FSX 2020 Flag
                            if (matchingCourse.FSX_2020 != null && matchingCourse.FSX_2020 == 1) {
                                return course
                            }
                        }
                    }
                    else {
                        return course;
                    }
                }).filter(function (course) {
                    // Price
                    if (searchCriteria.coursePrice.length > 0 || searchCriteria.coursePriceMax.length > 0) {

                        var matchingCourse = window.courseMediaArr.find(item => item.Name === course.Name);

                        if (typeof matchingCourse !== 'undefined') {
                            //Check Course Price
                            if (matchingCourse.Price != null) {
                                if (searchCriteria.coursePrice.length > 0 && searchCriteria.coursePriceSearchOperator == "=") {
                                    if (matchingCourse.Price == searchCriteria.coursePrice) {
                                        return course;
                                    }
                                }
                                else if (searchCriteria.coursePriceSearchOperator == ">") {
                                    var minPrice = (searchCriteria.coursePrice.length > 0) ? searchCriteria.coursePrice : -1;
                                    if (searchCriteria.coursePriceMax.length > 0) {
                                        if (matchingCourse.Price > minPrice && matchingCourse.Price < searchCriteria.coursePriceMax) {
                                            return course;
                                        }
                                    }
                                    else if (matchingCourse.Price > minPrice) {
                                        return course;
                                    }
                                }
                                else if (searchCriteria.coursePrice.length > 0) {
                                    if (matchingCourse.Price < searchCriteria.coursePrice) {
                                        return course;
                                    }
                                }
                            }
                        }
                    }
                    else {
                        return course;
                    }
                });

                var matchedCourses = [];
                $.each(matches, function () {
                    matchedCourses.push(this.Name);
                });

                Debug("# of courses matched: " + matchedCourses.length);
                $("#courseResultCount").html("Courses found: " + matchedCourses.length);
                Debug("courses matched: \r\n" + (matchedCourses.join('\r\n')));

                if (matchedCourses.length > 0) {

                    Debug("Hiding unmatched courses...");
                    document.querySelectorAll('.courseButton').forEach(function (el) {
                        if ($.inArray(HtmlDecode(el.innerHTML), matchedCourses) == -1) {
                            el.style.display = 'none';
                        }
                    });

                    if (matchedCourses.length == 1) {
                        Debug("Search had exact match, loading scorecard...");
                        loadScoreCard(matchedCourses[0]);
                    }
                }
                else {
                    Debug('nothing found in course search...');
                    document.querySelectorAll('.courseButton').forEach(function (el) {
                        el.style.display = 'none';
                    });
                }
            }
            else {
                Debug("Nothing to search for, resetting search...");
                searchCourseReset();
            }

            var result = document.getElementById("searchFooter");
            result.scrollIntoView();
        }
    </script>
</body>
</html>